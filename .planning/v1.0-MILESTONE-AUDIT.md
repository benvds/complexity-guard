---
milestone: v1.0
audited: 2026-02-22T21:00:00Z
status: gaps_found
scores:
  requirements: 85/89
  phases: 14/14
  integration: 14/18
  flows: 6/8
gaps:
  requirements:
    - id: "CLI-08"
      status: "unsatisfied"
      phase: "Phase 2"
      claimed_by_plans: ["02-01-PLAN.md"]
      completed_by_plans: ["02-01-SUMMARY.md"]
      verification_status: "passed (phase-level only — cross-phase wiring broken)"
      evidence: "--no-duplication flag parsed in args.zig and merged into cfg.analysis.no_duplication by merge.zig, but main.zig lines 276-288 never read cfg.analysis.no_duplication when computing duplication_enabled. The flag has zero runtime effect."
    - id: "CYCL-09"
      status: "partial"
      phase: "Phase 4"
      claimed_by_plans: ["04-02-PLAN.md"]
      completed_by_plans: ["04-02-SUMMARY.md"]
      verification_status: "passed (phase-level — CyclomaticConfig struct exists with configurable fields)"
      evidence: "main.zig line 229 hardcodes `cyclomatic.CyclomaticConfig.default()`. Config file thresholds.cyclomatic.warning/error are never read. Cognitive, Halstead, and structural thresholds ARE correctly read from config. Default values (10/20) always apply for cyclomatic."
    - id: "CFG-04"
      status: "partial"
      phase: "Phase 2"
      claimed_by_plans: ["02-02-PLAN.md"]
      completed_by_plans: ["02-02-SUMMARY.md"]
      verification_status: "passed (phase-level — ThresholdsConfig struct exists with cyclomatic field)"
      evidence: "Per-metric thresholds work correctly for cognitive, Halstead, and structural metrics. Cyclomatic thresholds in config file are silently ignored due to hardcoded default at main.zig:229. Partial satisfaction — 3/4 metric families work."
    - id: "PERF-01"
      status: "partial"
      phase: "Phase 12"
      claimed_by_plans: ["12-01-PLAN.md"]
      completed_by_plans: ["12-01-SUMMARY.md"]
      verification_status: "human_needed"
      evidence: "Parallel thread pool fully implemented and wired. No empirical benchmark against 10,000-file corpus exists. Extrapolation from webpack (6,889 files, 1.76s single-threaded) suggests compliance with parallelism, but unconfirmed on real hardware."
  integration:
    - from: "args.zig --no-duplication"
      to: "main.zig duplication_enabled"
      issue: "no_duplication config field never consulted — dead flag"
      affected_requirements: ["CLI-08"]
    - from: "config.zig ThresholdsConfig.cyclomatic"
      to: "main.zig CyclomaticConfig"
      issue: "Cyclomatic thresholds hardcoded to defaults, config file values ignored"
      affected_requirements: ["CYCL-09", "CFG-04"]
    - from: "main.zig writeDefaultConfigWithBaseline"
      to: "scoring.zig effective weights"
      issue: "Default config written by --save-baseline omits duplication: 0.20 weight"
      affected_requirements: ["COMP-03"]
    - from: "args.zig --metrics"
      to: "main.zig metric computation"
      issue: "Cyclomatic/cognitive always computed regardless of --metrics flag; only halstead/structural respect computation gate. Exit codes can be driven by non-requested metrics."
      affected_requirements: ["CLI-07"]
  flows:
    - flow: "complexity-guard --no-duplication ."
      breaks_at: "main.zig lines 276-288 — cfg.analysis.no_duplication never read"
    - flow: "complexity-guard --save-baseline . (first run)"
      breaks_at: "Written config omits duplication weight — subsequent --duplication runs get unexpected 4-metric normalization"
tech_debt:
  - phase: 04-cyclomatic-complexity
    items:
      - "TODO: function name extraction uses placeholders (<function>, <method>) instead of actual names"
  - phase: 06-cognitive-complexity
    items:
      - "Dead code: arrow_function branch in visitNode (lines 143-162) can never be reached"
  - phase: 07-halstead-structural-metrics
    items:
      - "ROADMAP.md checkbox for 07-05-PLAN.md not updated to [x]"
  - phase: 08-composite-health-score
    items:
      - "ROADMAP.md plan checkboxes not updated to [x]"
  - phase: 10.1-performance-benchmarks
    items:
      - "[RESULTS:] placeholder in docs/benchmarks.md subsystem breakdown section (data exists in JSON but not rendered into doc)"
  - phase: documentation
    items:
      - "REQUIREMENTS.md checkboxes stale for phases 2-8 (all [ ] when work is complete)"
      - "REQUIREMENTS.md traceability table phase numbers off by one for phases 5-8 (due to Phase 5.1 insertion shifting phases)"
      - "REQUIREMENTS.md count says '72 total' but traceability table contains 89 entries"
---

# v1.0 Milestone Audit Report

**Milestone:** v1.0 — ComplexityGuard
**Audited:** 2026-02-22
**Status:** gaps_found
**Score:** 85/89 requirements satisfied (4 with gaps)

## Executive Summary

ComplexityGuard v1.0 delivered all 14 phases covering the full feature set: CLI, config, parsing, cyclomatic/cognitive/Halstead/structural metrics, composite health scoring, console/JSON/SARIF/HTML output, duplication detection, and parallelization. All phase verifications passed. However, the cross-phase integration check uncovered 2 broken wiring issues and 2 partial behaviors that prevent full milestone sign-off.

The 4 gap requirements are all fixable with targeted changes to `src/main.zig` (the central orchestrator). No architectural issues or missing features — only wiring gaps between already-implemented modules.

---

## Phase Verification Summary

| Phase | Status | Score | Critical Gaps |
|-------|--------|-------|---------------|
| 01 Project Foundation | passed | 15/15 | None |
| 02 CLI & Configuration | passed | 7/7 | None (CLI-08 cross-phase gap found later) |
| 03 File Discovery & Parsing | passed | 6/6 | None |
| 04 Cyclomatic Complexity | passed | 6/6 | None (CYCL-09 cross-phase gap found later) |
| 05 Console & JSON Output | passed | 7/7 | None |
| 05.1 CI/CD, Release & Docs | passed | 10/10 | None |
| 06 Cognitive Complexity | passed | 22/22 | None |
| 07 Halstead & Structural | passed | 4/4 | None |
| 08 Composite Health Score | human_needed | 4/4 | Human verification granted during execution |
| 09 SARIF Output | passed | 12/12 | None |
| 10 HTML Reports | passed | 15/15 | None |
| 10.1 Performance Benchmarks | passed | 5/5 | None |
| 11 Duplication Detection | passed | 17/17 | None |
| 12 Parallelization & Distribution | human_needed | 12/13 | PERF-01 empirical validation pending |

**All 14 phases verified.** Phase-level gaps were all resolved during execution. Integration gaps below were found only through cross-phase wiring analysis.

---

## Requirements Coverage (3-Source Cross-Reference)

### Source Availability

| Source | Available | Notes |
|--------|-----------|-------|
| VERIFICATION.md | 14/14 phases | All present and substantive |
| SUMMARY.md `requirements_completed` | 0/50 plans | Field absent from all SUMMARYs — not used in this project |
| REQUIREMENTS.md traceability | 89 entries | Checkboxes stale for phases 2-8 |

### Requirements by Status

| Status | Count | Requirements |
|--------|-------|-------------|
| Satisfied | 82 | CLI-01 to CLI-07, CLI-09 to CLI-12, CFG-01 to CFG-03, CFG-05 to CFG-07, PARSE-01 to PARSE-06, CYCL-01 to CYCL-08, COGN-01 to COGN-09, HALT-01 to HALT-05, STRC-01 to STRC-06, COMP-01, COMP-02, OUT-CON-01 to OUT-CON-04, OUT-JSON-01 to OUT-JSON-03, CI-01 to CI-05, OUT-SARIF-01 to OUT-SARIF-04, OUT-HTML-01 to OUT-HTML-04, DUP-01 to DUP-07, PERF-02, DIST-01, DIST-02 |
| Satisfied (with override) | 1 | COMP-04 (letter grade overridden to numeric-only per CONTEXT.md) |
| Satisfied (with deviation) | 2 | COGN-05, COGN-06 (locked user deviation — each operator counted individually) |
| Partial | 4 | CLI-07, CLI-08, CFG-04, CYCL-09 |
| Needs human | 1 | PERF-01 |

**Note on COGN-05/06/08 deviations:** These are locked user design decisions documented in plans and docs, not implementation gaps. ComplexityGuard intentionally counts each logical operator as +1 (vs SonarSource's sequence grouping).

**Note on COMP-04 override:** CONTEXT.md formally overrides REQUIREMENTS.md to "numeric 0-100 only, no letter grades." All output layers comply. Not a gap.

### Unsatisfied/Partial Requirements Detail

#### CLI-08: `--no-duplication` flag (UNSATISFIED)

| Source | Finding |
|--------|---------|
| VERIFICATION (Phase 2) | Marked SATISFIED — flag parsed in args.zig, merged in merge.zig |
| Integration check | Flag has zero runtime effect — main.zig never reads `cfg.analysis.no_duplication` |
| REQUIREMENTS.md | `[ ]` (checkbox not updated) |
| **Final status** | **Unsatisfied** — wiring broken between merge.zig and main.zig |

**Fix:** Add `no_duplication` check at main.zig line ~276 in the `duplication_enabled` computation block.

#### CYCL-09: Configurable cyclomatic thresholds (PARTIAL)

| Source | Finding |
|--------|---------|
| VERIFICATION (Phase 4) | Marked SATISFIED — CyclomaticConfig struct has configurable fields |
| Integration check | main.zig:229 hardcodes `CyclomaticConfig.default()`, never reads config file thresholds |
| REQUIREMENTS.md | `[ ]` (checkbox not updated) |
| **Final status** | **Partial** — thresholds exist but cannot be customized via config file |

**Fix:** Replace hardcoded default at main.zig:229 with config-aware construction (same pattern as cognitive at lines 232-245).

#### CFG-04: Per-metric thresholds in config (PARTIAL)

| Source | Finding |
|--------|---------|
| VERIFICATION (Phase 2) | Marked SATISFIED — ThresholdsConfig has cyclomatic field |
| Integration check | Config cyclomatic thresholds silently ignored; cognitive/Halstead/structural work |
| REQUIREMENTS.md | `[ ]` (checkbox not updated) |
| **Final status** | **Partial** — 3 of 4 metric families configurable via file |

**Fix:** Same fix as CYCL-09 — read config thresholds for cyclomatic in main.zig.

#### PERF-01: 10,000 files in under 2 seconds (NEEDS HUMAN)

| Source | Finding |
|--------|---------|
| VERIFICATION (Phase 12) | Marked human_needed — parallel pipeline implemented, no empirical benchmark |
| Integration check | Parallel path wired correctly; no 10k-file test exists |
| REQUIREMENTS.md | `[x]` (checkbox marked complete) |
| **Final status** | **Needs human** — implementation present, empirical validation pending |

**Validation:** Run parallel analysis against 10,000-file corpus on multi-core machine to confirm < 2s wall time.

### Orphan Detection

No orphaned requirements found. All 89 requirements in the traceability table are referenced by at least one phase VERIFICATION.md.

---

## Cross-Phase Integration Results

### Summary

| Category | Connected | Issues |
|----------|-----------|--------|
| Phase exports wired | 18 | 0 orphaned |
| Missing connections | — | 4 found |
| E2E flows complete | 6 | 2 broken |

### Connected Wiring (18 verified connections)

All major phase-to-phase connections are wired through `src/main.zig`:

- **Phase 2 → 3+:** CLI args parsed → config loaded → merged → pipeline begins
- **Phase 3 → 4+:** `parse.parseFiles()` supplies `ParseResult` to all metric modules
- **Phase 4 → 6:** `ThresholdResult` carries both `complexity` and `cognitive_complexity`
- **Phase 4 → 7:** `ThresholdResult` extended with Halstead and structural fields
- **Phase 4 → 8:** `scoring.computeFunctionScore()` reads all metric fields from `ThresholdResult`
- **Phase 8 → 5 (all outputs):** `project_score` and `file_results` passed to console, JSON, SARIF, HTML
- **Phase 11 → outputs:** `dup_result` threaded to all four output formatters
- **Phase 12 → pipeline:** Parallel path runs identical metric chain; results sorted for determinism
- **Exit codes:** `countViolations` checks all 9 metric status fields; integrates parse errors, baseline failures

### Missing Connections (4 issues)

1. **`--no-duplication` → `duplication_enabled`** (CLI-08): Flag parsed and merged but never consulted
2. **`config.thresholds.cyclomatic` → `CyclomaticConfig`** (CYCL-09, CFG-04): Config values ignored, defaults hardcoded
3. **`writeDefaultConfigWithBaseline` → duplication weight** (COMP-03): Default config omits `duplication: 0.20`
4. **`--metrics` → computation gating** (CLI-07): Cyclomatic/cognitive always computed regardless of flag; asymmetric with Halstead/structural

### E2E Flow Results

| Flow | Status | Notes |
|------|--------|-------|
| `complexity-guard .` | Complete | Full metric pipeline → console → exit code |
| `complexity-guard --format json --output report.json .` | Complete | Full pipeline → JSON with all metrics |
| `complexity-guard --format sarif .` | Complete | Full pipeline → SARIF with all violations |
| `complexity-guard --format html --output report.html .` | Complete | Full pipeline → HTML with dashboard/charts |
| `complexity-guard --duplication .` | Complete | Duplication pass → all output formats |
| `complexity-guard --threads 4 .` | Complete | Parallel path → deterministic output |
| `complexity-guard --no-duplication .` | **Broken** | Flag has no effect (dead wiring) |
| `complexity-guard --save-baseline .` (first run) | **Partial** | Config written but omits duplication weight |

---

## Tech Debt Summary

### By Phase

| Phase | Items | Severity |
|-------|-------|----------|
| 04 Cyclomatic | Function name extraction uses placeholders (`<function>`, `<method>`) | Info |
| 06 Cognitive | Dead code: unreachable `arrow_function` branch in `visitNode` | Info |
| 07 Halstead | ROADMAP.md checkbox for 07-05-PLAN.md not marked `[x]` | Info |
| 08 Health Score | ROADMAP.md plan checkboxes not marked `[x]` | Info |
| 10.1 Benchmarks | `[RESULTS:]` placeholder in docs/benchmarks.md (data exists in JSON files) | Info |
| Documentation | REQUIREMENTS.md checkboxes stale for phases 2-8 | Warning |
| Documentation | REQUIREMENTS.md traceability phase numbers off-by-one (phases 5-8) due to 5.1 insertion | Warning |
| Documentation | REQUIREMENTS.md says "72 total" but table has 89 entries | Info |

**Total: 8 items across 7 phases/categories** — all Info/Warning severity, no blockers.

---

## Conclusion

ComplexityGuard v1.0 is substantially complete. All 14 phases delivered their features, all 14 verifications passed at the phase level, and the core analysis pipeline works end-to-end. The 4 gap requirements are all cross-phase wiring issues concentrated in `src/main.zig` — fixable with targeted changes (estimated: 1 small plan).

The most impactful gaps are:
1. **CYCL-09/CFG-04** — cyclomatic thresholds not configurable via file (affects power users)
2. **CLI-08** — `--no-duplication` flag dead (low impact since duplication is off by default)

---

_Audited: 2026-02-22T21:00:00Z_
_Auditor: Claude (audit-milestone orchestrator)_
