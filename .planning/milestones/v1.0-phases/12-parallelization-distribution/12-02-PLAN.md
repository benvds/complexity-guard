---
phase: 12-parallelization-distribution
plan: 02
type: execute
wave: 2
depends_on:
  - 12-01
files_modified:
  - README.md
  - docs/getting-started.md
  - docs/cli-reference.md
  - docs/examples.md
  - docs/benchmarks.md
  - publication/npm/README.md
  - publication/npm/packages/complexity-guard-linux-x64/README.md
  - publication/npm/packages/complexity-guard-linux-arm64/README.md
  - publication/npm/packages/complexity-guard-darwin-x64/README.md
  - publication/npm/packages/complexity-guard-darwin-arm64/README.md
  - publication/npm/packages/complexity-guard-win32-x64/README.md
autonomous: true
requirements:
  - DIST-01
  - DIST-02

must_haves:
  truths:
    - "Binary size is under 5 MB for all cross-compilation targets (verified)"
    - "Cross-compilation to all 5 targets works (verified via zig build -Dtarget)"
    - "README documents --threads flag and parallel processing capability"
    - "CLI reference documents --threads flag with examples"
    - "Getting started page mentions parallel processing"
    - "Publication READMEs list parallel processing as a feature"
  artifacts:
    - path: "README.md"
      provides: "Updated feature list with parallel processing, --threads flag in CLI reference"
      contains: "--threads"
    - path: "docs/cli-reference.md"
      provides: "--threads flag documentation with usage examples"
      contains: "--threads"
    - path: "docs/getting-started.md"
      provides: "Mention of parallel processing capability"
    - path: "docs/examples.md"
      provides: "Example of --threads usage"
    - path: "docs/benchmarks.md"
      provides: "Updated with parallelization context"
  key_links:
    - from: "README.md"
      to: "docs/cli-reference.md"
      via: "Link to CLI reference for --threads details"
      pattern: "cli-reference"
    - from: "publication/npm/README.md"
      to: "README.md"
      via: "Feature list sync between main and publication READMEs"
      pattern: "parallel|thread"
---

<objective>
Verify cross-compilation and binary size requirements, then update all documentation to reflect parallelization and threading capabilities.

Purpose: DIST-01 (binary < 5 MB) and DIST-02 (cross-compilation to 5 targets) are already implemented in CI but need explicit verification after adding thread pool code. Documentation must reflect the new --threads flag and parallel processing capability so users know how to use it.

Output: Verified binary sizes, updated README, docs pages, and publication READMEs.
</objective>

<execution_context>
@/home/ben/.claude/get-shit-done/workflows/execute-plan.md
@/home/ben/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-parallelization-distribution/12-CONTEXT.md
@.planning/phases/12-parallelization-distribution/12-01-SUMMARY.md
@README.md
@docs/getting-started.md
@docs/cli-reference.md
@docs/examples.md
@docs/benchmarks.md
@publication/npm/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify cross-compilation and binary size for all targets</name>
  <files></files>
  <action>
Verify DIST-01 (binary under 5 MB) and DIST-02 (cross-compiles to all 5 targets) by building for each target:

1. **Build for each target with release optimization:**
   ```
   zig build -Dtarget=x86_64-linux -Doptimize=ReleaseSafe
   ls -lh zig-out/bin/complexity-guard

   zig build -Dtarget=aarch64-linux -Doptimize=ReleaseSafe
   ls -lh zig-out/bin/complexity-guard

   zig build -Dtarget=x86_64-macos -Doptimize=ReleaseSafe
   ls -lh zig-out/bin/complexity-guard

   zig build -Dtarget=aarch64-macos -Doptimize=ReleaseSafe
   ls -lh zig-out/bin/complexity-guard

   zig build -Dtarget=x86_64-windows -Doptimize=ReleaseSafe
   ls -lh zig-out/bin/complexity-guard.exe
   ```

2. **Record sizes:** Note each binary size. All must be under 5 MB.

3. **If any target exceeds 5 MB:** Add `-fstrip` to the build command (strips debug symbols). The CI release workflow already uses this. If still over 5 MB, switch to `ReleaseSmall` for that target.

4. **No file changes needed for this task** — it is a verification step only. Record results for the SUMMARY.

5. **After verification, rebuild the default target** so the local binary is correct:
   ```
   zig build
   ```
  </action>
  <verify>
All 5 cross-compilation targets build successfully. All binary sizes are under 5 MB. `zig build` succeeds for native target after verification.
  </verify>
  <done>
Cross-compilation to x86_64-linux, aarch64-linux, x86_64-macos, aarch64-macos, and x86_64-windows verified. All binaries under 5 MB. DIST-01 and DIST-02 confirmed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update documentation for parallelization and threading</name>
  <files>
    README.md
    docs/getting-started.md
    docs/cli-reference.md
    docs/examples.md
    docs/benchmarks.md
    publication/npm/README.md
    publication/npm/packages/complexity-guard-linux-x64/README.md
    publication/npm/packages/complexity-guard-linux-arm64/README.md
    publication/npm/packages/complexity-guard-darwin-x64/README.md
    publication/npm/packages/complexity-guard-darwin-arm64/README.md
    publication/npm/packages/complexity-guard-win32-x64/README.md
  </files>
  <action>
Update all user-facing documentation to reflect the new parallelization capability.

1. **README.md:**
   - Add "Parallel Processing" or "Multi-threaded analysis" to the feature list/highlights
   - Mention auto-detection of CPU cores for parallel analysis
   - Add `--threads N` to the CLI flags table/section
   - Add a note like "Analyzes files in parallel across all CPU cores by default"
   - Keep the TanStack/Astro friendly tone (per prior decisions)

2. **docs/cli-reference.md:**
   - Add `--threads N` flag documentation:
     - Description: Set the number of threads for parallel file analysis
     - Default: auto-detect CPU cores (all available)
     - `--threads 1` disables parallelization (useful for debugging)
     - Also configurable via `threads` field in `.complexityguard.json` analysis section
     - Flag overrides config file value
   - Add the `threads` field to the config file schema reference section
   - Add `elapsed_ms` and `thread_count` fields to the JSON output schema section (under metadata)

3. **docs/getting-started.md:**
   - Add a brief mention that the tool automatically uses all CPU cores for fast analysis
   - Example: "ComplexityGuard analyzes files in parallel by default, using all available CPU cores"

4. **docs/examples.md:**
   - Add a "Performance" or "Threading" example section:
     - `complexity-guard --threads 4 src/` — limit to 4 threads
     - `complexity-guard --threads 1 src/` — single-threaded mode for debugging
     - `complexity-guard --verbose src/` — see timing information
   - Show JSON output snippet with metadata section

5. **docs/benchmarks.md:**
   - Add context about parallelization: "These benchmarks were captured in single-threaded mode. With multi-threading enabled (default), expect near-linear speedup with core count."
   - Note that parallelization is available since version 0.7.0 (or whatever version is current)

6. **publication/npm/README.md:**
   - Add "Multi-threaded parallel analysis" to the feature list
   - Keep in sync with main README feature list

7. **Platform package READMEs (all 5):**
   - Add "Multi-threaded parallel analysis" to the "What ComplexityGuard Measures" or feature section if it exists
   - Keep brief — these are platform-specific install packages
  </action>
  <verify>
Grep for "--threads" in README.md, docs/cli-reference.md, docs/examples.md — all present. Grep for "parallel" in publication/npm/README.md — present. All documentation files render correctly (no broken markdown).
  </verify>
  <done>
All documentation updated: README features parallel processing, CLI reference documents --threads flag, getting-started mentions auto-parallelization, examples show threading usage, benchmarks contextualize single-threaded results, publication READMEs list multi-threading.
  </done>
</task>

</tasks>

<verification>
1. Cross-compilation verified for all 5 targets with binary sizes recorded
2. All binaries under 5 MB (DIST-01)
3. All 5 cross-compilation targets build (DIST-02)
4. `grep -r "threads" README.md docs/cli-reference.md docs/examples.md` — all contain --threads documentation
5. `grep -r "parallel\|thread" publication/npm/README.md` — publication README mentions parallel processing
6. No broken markdown links in documentation files
</verification>

<success_criteria>
- All 5 cross-compilation targets build successfully
- All binary sizes under 5 MB
- --threads flag documented in CLI reference with usage examples
- Parallel processing mentioned in README, getting-started, and publication READMEs
- JSON metadata (elapsed_ms, thread_count) documented in CLI reference
- Benchmarks page updated with parallelization context
</success_criteria>

<output>
After completion, create `.planning/phases/12-parallelization-distribution/12-02-SUMMARY.md`
</output>
