---
phase: 10-html-reports
plan: 04
type: execute
wave: 1
depends_on: []
files_modified: [src/output/html_output.zig]
autonomous: true
requirements: [OUT-HTML-01, OUT-HTML-02]
gap_closure: true

must_haves:
  truths:
    - "Dashboard shows numeric health score only, no letter grade anywhere"
    - "File table fits mobile viewports with path truncated from the left (directory prefix hidden, filename visible)"
  artifacts:
    - path: "src/output/html_output.zig"
      provides: "HTML report generation without letter grade, with mobile-friendly file paths"
  key_links:
    - from: "writeDashboard()"
      to: "HTML output"
      via: "score-panel div"
      pattern: "health-score score-"
---

<objective>
Close two UAT gaps in the HTML report: (1) remove the letter grade entirely from the dashboard, and (2) fix file path truncation on mobile viewports so the ellipsis clips the directory prefix (left side) rather than the filename (right side).

Purpose: User explicitly requested no letter grade and reported the table overflows on mobile.
Output: Updated html_output.zig with both fixes, all tests passing.
</objective>

<execution_context>
@/Users/benvds/.claude/get-shit-done/workflows/execute-plan.md
@/Users/benvds/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-html-reports/10-UAT.md
@src/output/html_output.zig
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove letter grade from dashboard</name>
  <files>src/output/html_output.zig</files>
  <action>
Remove all letter grade functionality from the HTML report:

1. Delete the `scoreToGrade` function (around line 238-245) entirely.

2. Delete the `.grade` CSS rule (around line 64): `.grade { font-size: 2rem; color: var(--muted); margin-left: 0.25rem; }`

3. In `writeDashboard()` (around line 443): remove the `const grade = scoreToGrade(project_score);` line.

4. In the score panel print statement (around lines 457-461): change the format string from:
   `<div class=\"health-score score-{s}\">{d:.0}<span class=\"grade\">{s}</span></div>\n`
   with 3 format args (.{ color_class, project_score, grade })
   to:
   `<div class=\"health-score score-{s}\">{d:.0}</div>\n`
   with 2 format args (.{ color_class, project_score })

5. Delete the `test "scoreToGrade"` test block (around lines 673-683).

Do NOT touch `scoreToColorClass` or any other function -- only grade-related code.
  </action>
  <verify>Run `zig build test` -- all tests pass with no compilation errors. Grep the file for "grade" and "scoreToGrade" to confirm zero occurrences remain.</verify>
  <done>No letter grade function, CSS, rendering, or test exists in html_output.zig. The dashboard shows only the numeric score.</done>
</task>

<task type="auto">
  <name>Task 2: Fix file path truncation for mobile viewports</name>
  <files>src/output/html_output.zig</files>
  <action>
Fix the file path column in the file table so long paths truncate from the left (hiding directory prefix) instead of from the right (hiding filename):

1. In the CSS rule for `.file-row td:first-child` (around line 136), change:
   ```
   .file-row td:first-child { font-family: monospace; font-size: 0.8rem; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
   ```
   to:
   ```
   .file-row td:first-child { font-family: monospace; font-size: 0.8rem; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; direction: rtl; unicode-bidi: plaintext; }
   ```
   Changes: (a) reduce max-width from 400px to 300px, (b) add `direction: rtl;` and `unicode-bidi: plaintext;` so text-overflow ellipsis clips from the left.

2. Add a mobile breakpoint media query in the CSS section (after the existing `.fn-table` rules, before the `/* Metric bars */` comment, around line 149). Add:
   ```
   @media (max-width: 600px) { .file-row td:first-child { max-width: 160px; } }
   ```
   This ensures on narrow viewports the path column shrinks further.

Note: The `direction: rtl` with `unicode-bidi: plaintext` trick causes the text to render LTR visually but the overflow/ellipsis to clip from the start of the string. So `directory-a/directory-b/file.js` becomes `...ctory-b/file.js` when truncated.
  </action>
  <verify>Run `zig build test` -- all tests pass. Grep for "direction: rtl" and "max-width: 600px" to confirm both CSS changes are present in the file.</verify>
  <done>File path column uses RTL direction for left-side ellipsis truncation, max-width reduced to 300px, and a 600px mobile breakpoint further reduces to 160px.</done>
</task>

</tasks>

<verification>
1. `zig build test` passes with zero failures
2. `zig build run -- --format html --output /tmp/cg-report-gap.html tests/fixtures/` produces a valid HTML file
3. Grep html_output.zig for "scoreToGrade" returns no matches
4. Grep html_output.zig for "grade" returns no matches (the CSS class and function are both gone)
5. Grep html_output.zig for "direction: rtl" returns a match
6. Grep html_output.zig for "max-width: 600px" returns a match (mobile breakpoint present)
</verification>

<success_criteria>
- HTML report dashboard displays numeric health score only (no letter grade)
- File path column truncates from the left on narrow viewports, preserving the filename at the end
- All existing tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/10-html-reports/10-04-SUMMARY.md`
</output>
