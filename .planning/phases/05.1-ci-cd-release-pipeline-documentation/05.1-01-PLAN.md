---
phase: 05.1-ci-cd-release-pipeline-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - CHANGELOG.md
  - scripts/release.sh
  - .github/workflows/test.yml
autonomous: true

must_haves:
  truths:
    - "CHANGELOG.md exists with Keep a Changelog format documenting 0.1.0 features"
    - "scripts/release.sh bumps version in main.zig, commits, and creates git tag"
    - "CI test workflow runs zig build test on Ubuntu and macOS for PRs and push to main"
  artifacts:
    - path: "CHANGELOG.md"
      provides: "Keep a Changelog formatted release history"
      contains: "## [0.1.0]"
    - path: "scripts/release.sh"
      provides: "Version bump, git commit, git tag automation"
      contains: "sed"
    - path: ".github/workflows/test.yml"
      provides: "CI test pipeline for PRs and push to main"
      contains: "mlugg/setup-zig"
  key_links:
    - from: "scripts/release.sh"
      to: "src/main.zig"
      via: "sed version replacement"
      pattern: "const version"
---

<objective>
Set up release infrastructure: changelog with initial 0.1.0 entry, release shell script for version bumping and git tagging, and CI test workflow running on Ubuntu + macOS.

Purpose: Establish the version management and continuous testing foundation that all other release/distribution plans depend on.
Output: CHANGELOG.md, scripts/release.sh, .github/workflows/test.yml
</objective>

<execution_context>
@/Users/benvds/.claude/get-shit-done/workflows/execute-plan.md
@/Users/benvds/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05.1-ci-cd-release-pipeline-documentation/05.1-CONTEXT.md
@.planning/phases/05.1-ci-cd-release-pipeline-documentation/05.1-RESEARCH.md
@src/main.zig
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CHANGELOG.md and release script</name>
  <files>CHANGELOG.md, scripts/release.sh</files>
  <action>
Create CHANGELOG.md in project root following Keep a Changelog 1.1.0 format (https://keepachangelog.com/en/1.1.0/). Include:
- Header with format reference and SemVer reference links
- `## [Unreleased]` section (empty)
- `## [0.1.0] - 2026-02-15` section with Added items documenting current features:
  - Cyclomatic complexity analysis for TypeScript/JavaScript functions
  - Console output with ESLint-style formatting and threshold indicators
  - JSON output format for CI integration
  - Configuration file support (.complexityguard.json)
  - Configurable thresholds (warning: 10, error: 20)
  - Recursive file discovery with extension filtering (.ts, .tsx, .js, .jsx)
  - Tree-sitter based parsing with error-tolerant syntax handling
  - CLI with --help, --version, --verbose, --quiet, --format, --output, --config, --init flags
- Only include sections with content (no empty Changed/Deprecated/Removed/Fixed/Security sections)
- Bottom comparison links section

Create scripts/release.sh (make executable with chmod +x). The script:
- Uses `set -euo pipefail` for strict error handling
- Accepts single argument: major, minor, or patch (default: patch)
- Reads current version from `src/main.zig` by grepping `const version = "..."`
- Parses semver components using IFS='.' and read
- Computes new version based on bump type
- Updates version in src/main.zig using sed (use sed -i '' on macOS, handle with portable pattern)
- Updates version in package.json if it exists (same sed pattern)
- Updates version in npm/*/package.json platform packages if they exist
- Runs `git add` on changed files, `git commit -m "chore: release v$NEW_VERSION"`, `git tag -a "v$NEW_VERSION" -m "Release $NEW_VERSION"`
- Prints success message with instruction to push: `git push origin main --follow-tags`
- Use portable sed: create .bak then rm .bak (works on both macOS and Linux)

Reference GSD project patterns per user specifics. Do NOT use interactive prompts -- the script is fully non-interactive.
  </action>
  <verify>
Run `cat CHANGELOG.md` and verify Keep a Changelog format with 0.1.0 entry.
Run `bash -n scripts/release.sh` to verify script syntax.
Run `ls -la scripts/release.sh` to verify executable permission.
  </verify>
  <done>CHANGELOG.md exists with 0.1.0 release entry documenting all current features. scripts/release.sh is executable, parses version from main.zig, and bumps version in all source files before committing and tagging.</done>
</task>

<task type="auto">
  <name>Task 2: Create CI test workflow</name>
  <files>.github/workflows/test.yml</files>
  <action>
Create .github/workflows/test.yml. Per locked decisions: tests run on both PRs (required check) and push to main, on macOS + Linux (Ubuntu + macOS runners).

Workflow structure:
- name: Test
- triggers: pull_request (branches: [main]) and push (branches: [main])
- Single job `test` with matrix strategy: os: [ubuntu-latest, macos-latest]
- runs-on: ${{ matrix.os }}
- Steps:
  1. actions/checkout@v4
  2. mlugg/setup-zig@v2 with version: 0.15.2
  3. Run tests: `zig build test`
  4. Build release binary (smoke test): `zig build -Doptimize=ReleaseSafe`

Keep it minimal. No caching (Zig is fast). No artifact upload (that's for release workflow).
  </action>
  <verify>
Run `cat .github/workflows/test.yml` to verify YAML structure.
Verify it contains: pull_request, push, matrix with ubuntu-latest and macos-latest, mlugg/setup-zig@v2, zig build test.
  </verify>
  <done>CI test workflow triggers on PRs and push to main, runs tests on Ubuntu + macOS using mlugg/setup-zig with Zig 0.15.2, includes release binary smoke test.</done>
</task>

</tasks>

<verification>
- CHANGELOG.md follows Keep a Changelog 1.1.0 format exactly
- scripts/release.sh passes bash syntax check and is executable
- .github/workflows/test.yml is valid YAML with correct triggers and matrix
- Version 0.1.0 in main.zig matches CHANGELOG.md version
</verification>

<success_criteria>
- CHANGELOG.md exists with properly formatted 0.1.0 entry
- scripts/release.sh automates version bump + commit + tag workflow
- .github/workflows/test.yml runs tests on PR and push to main on Linux + macOS
</success_criteria>

<output>
After completion, create `.planning/phases/05.1-ci-cd-release-pipeline-documentation/05.1-01-SUMMARY.md`
</output>
