---
phase: 13-gap-closure-pipeline-wiring
plan: "02"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cli/args.zig
  - src/main.zig
  - src/cli/help.zig
  - docs/cli-reference.md
  - docs/health-score.md
  - docs/getting-started.md
  - docs/examples.md
autonomous: true
requirements: [CLI-08]
gap_closure: true

must_haves:
  truths:
    - "--save-baseline flag is not recognized by the CLI parser"
    - "Running with --save-baseline produces an unknown flag error"
    - "Help text does not mention --save-baseline"
    - "Documentation does not reference --save-baseline as a valid option"
  artifacts:
    - path: "src/cli/args.zig"
      provides: "CliArgs struct without save_baseline field"
      contains: "no save_baseline field"
    - path: "src/main.zig"
      provides: "Main pipeline without save-baseline handler"
      contains: "no writeDefaultConfigWithBaseline function"
    - path: "src/cli/help.zig"
      provides: "Help text without --save-baseline line"
      contains: "no --save-baseline"
  key_links:
    - from: "src/cli/args.zig"
      to: "src/main.zig"
      via: "CliArgs struct no longer has save_baseline field"
      pattern: "no cli_args.save_baseline reference"
---

<objective>
Remove --save-baseline flag entirely from the codebase and all documentation.

Purpose: User reported that --save-baseline should be removed. Baseline should be set manually in the config file or via --fail-health-below. The --init command (plan 03) will generate a complete config including the baseline field for users to edit.
Output: Clean codebase with no --save-baseline references in source or docs.
</objective>

<execution_context>
@/home/ben/.claude/get-shit-done/workflows/execute-plan.md
@/home/ben/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-gap-closure-pipeline-wiring/13-UAT.md
@.planning/debug/save-baseline-init-config.md
@.planning/phases/13-gap-closure-pipeline-wiring/13-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove --save-baseline from source code</name>
  <files>
    src/cli/args.zig
    src/main.zig
    src/cli/help.zig
  </files>
  <action>
In src/cli/args.zig:
- Remove the `save_baseline: bool = false` field from the CliArgs struct (line 21)
- Remove the parsing branch for `"save-baseline"` (lines 78-79: `} else if (std.mem.eql(u8, flag, "save-baseline")) { cli_args.save_baseline = true; }`)
- Remove the test `"parse --save-baseline sets save_baseline flag"` (lines 251-260)

In src/main.zig:
- Remove the entire `writeDefaultConfigWithBaseline` function (lines 28-48)
- Remove the entire `if (cli_args.save_baseline) { ... }` handler block (lines 619-675). This block computes rounded score, reads/writes config with baseline, and prints "Baseline saved". Remove ALL of it including the closing brace.
- Do NOT remove anything else from main.zig. The baseline enforcement logic (cli_args.fail_health_below and cfg.baseline checks at lines ~697-723) must remain untouched.

In src/cli/help.zig:
- Remove the line containing `--save-baseline` from the help text (line 28: `\\      --save-baseline        Save current health score as baseline in config`)
  </action>
  <verify>
Run `zig build test` -- all tests pass (the removed test no longer exists, no compilation errors from removed field/function).
Run `grep -r "save.baseline" src/` -- returns zero matches (only planning files should have references).
  </verify>
  <done>
The save_baseline field, its parser branch, its handler in main.zig, the writeDefaultConfigWithBaseline helper, the help text line, and the test are all removed. `zig build test` passes with no errors. No source file under src/ references save_baseline or save-baseline.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove --save-baseline from documentation</name>
  <files>
    docs/cli-reference.md
    docs/health-score.md
    docs/getting-started.md
    docs/examples.md
  </files>
  <action>
In docs/cli-reference.md:
- Remove the entire `--save-baseline` section (lines 271-287). This includes the heading, description, code example, and explanation text. The section starts with `**\`--save-baseline\`**` and ends before `### Configuration`.
- In the "baseline" config option description (around line 541), remove the phrase "Set automatically by `--save-baseline`." and replace with "Set this value manually in your config file."
- In the "See Also" section at the end of the health score config option, if `--save-baseline` is referenced, remove that reference.

In docs/health-score.md:
- Rewrite the "Baseline + Ratchet Workflow" section (lines ~132-181). Remove all references to --save-baseline. The workflow should become:
  Step 1: "Set a Baseline" -- explain that users set the baseline value manually in .complexityguard.json (either by editing the config file directly, or by running with --format json to see the project score and then adding it to config). Show the JSON snippet with `"baseline": 73.2`.
  Step 2: "Enforce in CI" -- keep as-is (runs complexity-guard and enforces baseline from config, or use --fail-health-below).
  Step 3: "Improve Over Time" -- update to say "update the baseline value in your config file" instead of "re-run with --save-baseline".
- In the "See Also" section at the bottom, remove `--save-baseline` from the CLI Reference bullet point.

In docs/getting-started.md:
- Rewrite the "Tracking Health Over Time" section (around lines 347-365). Remove the `--save-baseline` command. Instead show:
  1. Generate config with --init
  2. Edit the config to add a baseline value (show editing the generated config)
  3. In CI: enforce the baseline
  4. Or override from CLI with --fail-health-below

In docs/examples.md:
- Rewrite the "Baseline + Ratchet Workflow" section (around lines 237-261). Remove `--save-baseline` from Step 2. Instead show:
  Step 1: Generate default config with --init
  Step 2: Edit .complexityguard.json to add baseline (show a JSON snippet)
  Step 3: Enforce in CI
  Step 4: Or use --fail-health-below

Do NOT modify CHANGELOG.md (it is historical record).
Do NOT modify any .planning/ files (they are historical record).
  </action>
  <verify>
Run `grep -r "save-baseline\|save_baseline" docs/` -- returns zero matches.
Read the modified docs to verify they are coherent and the baseline workflow makes sense without --save-baseline.
  </verify>
  <done>
All four documentation files have been updated. Zero references to --save-baseline in any docs/ file. The baseline workflow documentation now instructs users to set baseline manually in config. All examples use --fail-health-below or manual config editing instead of --save-baseline.
  </done>
</task>

</tasks>

<verification>
1. `zig build test` passes with no errors
2. `grep -rn "save.baseline" src/` returns zero matches
3. `grep -rn "save-baseline" docs/` returns zero matches
4. `zig build` produces a working binary
5. The binary rejects `--save-baseline` with an unknown flag error
</verification>

<success_criteria>
--save-baseline is completely removed from the tool: the flag is unrecognized, the handler is gone, the helper function is gone, and no documentation references it. All tests pass. The baseline workflow in docs uses manual config editing and --fail-health-below instead.
</success_criteria>

<output>
After completion, create `.planning/phases/13-gap-closure-pipeline-wiring/13-02-SUMMARY.md`
</output>
